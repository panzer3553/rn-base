// An All Components Screen is a great way to dev and quick-test components
<<<<<<< HEAD
import React, { View, Text, PropTypes, StyleSheet, Alert} from 'react-native'
=======
import React, { 
    View, 
    ScrollView, 
    Text, 
    TouchableOpacity, 
    PropTypes, 
    StyleSheet,
    Alert,
    TouchableHighlight
} from 'react-native'
>>>>>>> 658c79da3fbe2a5cbec688b795f624538f54a5a3
import { connect } from 'react-redux'
import styles from './Styles/AllComponentsScreenStyle'
import { Colors, Images, Metrics } from '../Themes'
import Actions from '../Actions/Creators'
import Routes from '../Navigation/Routes'
import MapScreen from '../Components/MapScreen'
import BubblePopUp from './BubblePopUp.js'
// external libs
import Icon from 'react-native-vector-icons/FontAwesome'
import {MKButton,MKColor} from 'react-native-material-kit'
import Communications from 'react-native-communications'
// I18n
import I18n from '../I18n/I18n.js'
<<<<<<< HEAD
import VectorIcon from 'react-native-vector-icons/Ionicons'
import mapstyle from './Styles/MapScreenStyle'
import CircleIcon from '../Components/CircleIcon'
import MapScreen from '../Components/MapScreen'
import BubblePopUp from './BubblePopUp.js'
import Communications from 'react-native-communications'
=======
>>>>>>> 658c79da3fbe2a5cbec688b795f624538f54a5a3

var fireItems = [ 
     {icon: 'fire', text: 'Show Info Screen', func: 'showHelpScreen'}, 
     {icon: 'fire', text: 'Show Location', func: 'showUserLocation'}, 
     {icon: 'fire', text: 'Location Info', func: 'JSONLocation'}, 
<<<<<<< HEAD
   ];
=======
    ]
>>>>>>> 658c79da3fbe2a5cbec688b795f624538f54a5a3

export default class AllComponentsScreen extends React.Component {

  constructor (props) {
    super(props)
    this.state = {
      isPopupShow: false,
      items: [],
    }
  }

  static propTypes = {
    navigator: PropTypes.object.isRequired,
    dispatch: PropTypes.func,
<<<<<<< HEAD
  };
=======
    latitude:  PropTypes.number,
    longitude: PropTypes.number,
  }
>>>>>>> 658c79da3fbe2a5cbec688b795f624538f54a5a3


  componentWillMount () {
    this.props.navigator.state.tapHamburger = () => {
      this.props.navigator.drawer.toggle()
    }
  }

<<<<<<< HEAD
=======
  // fires when the user presses the login button
  handlePressLogin () {
    const { navigator } = this.props
    const route = Routes.LoginScreen
    navigator.push(route)
  }

  // fires when the user presses the logout button
  handlePressLogout () {
    const { dispatch } = this.props
    dispatch(Actions.logout())
  }

  handleRequestLocation() {
    const { dispatch } = this.props
    dispatch(Actions.requestLocation())
  }
>>>>>>> 658c79da3fbe2a5cbec688b795f624538f54a5a3

  handleShowPopUp (_items) {
    this.setState({items: _items})
    this.setState({isPopupShow: true})
  }

  handleClosePopUp () {
    this.setState({isPopupShow: false})
  }

  render () {
<<<<<<< HEAD
=======
    const { loggedIn } = this.props
    //console.log('__' + Metrics.screenHeight )
>>>>>>> 658c79da3fbe2a5cbec688b795f624538f54a5a3
    const PlainFab = MKButton.plainFab()
    .withStyle({width:80, height: 80})
    .build()

    const SmallPlainFab = MKButton.plainFab()
    .withStyle({width:60, height: 60})
<<<<<<< HEAD
    .build()

    const bottomButtons = this.state.isPopupShow ? null : (
        <View style={mapstyle.icons_container}>
          <PlainFab onPress={this.showConfirmDialog.bind(this, 
                                                    'Do you want to make this call ?',
                                                    'Only make this call when you are in an emergency situation! ' +
                                                     'Please confirm to make the call to FIRE STATION: ',
                                                     '+84982709185' )}>
            <Icon name="fire" size={Metrics.icons.medium} color="red" />
=======
    .build();


    if (this.state.isPopupShow) {
        return (
          <View style={styles.screenContainer}>
            <MapScreen />
            <View style={styles.infoIconContainer}>
              <SmallPlainFab onPress={this.handleShowPopUp.bind(this, fireItems)}>
                <Icon name="info" 
                    size={Metrics.icons.small} 
                    color={Colors.error} 
                />
              </SmallPlainFab>
            </View>
            <BubblePopUp  
                items={this.state.items}
                elementWidth={Metrics.screenWidth * 4 / 5}
                elementHeight={30}
                isVisible={this.state.isPopupShow}
                onClose={this.handleClosePopUp.bind(this)}
                navigator={this.props.navigator}
                dispatch={this.props.dispatch}
            />
         </View>
      )
    }

    return (
      <View style={styles.screenContainer}>
        <MapScreen />
        <View style={styles.infoIconContainer}>
          <SmallPlainFab onPress={this.handleShowPopUp.bind(this, fireItems)}>
            <Icon name="info" 
                size={Metrics.icons.small} 
                color={Colors.error} 
            />
          </SmallPlainFab>
        </View>
        <View style={styles.icons_group_container}>
         <PlainFab  onPress={this.showConfirmDialog.bind(this, I18n.t('urgentCallTitle'),
                                                     I18n.t('urgentFireCallMessage'),
                                                     '+84982709185')}>
            <Icon 
              name='ambulance'
              size={Metrics.icons.medium} 
              color={Colors.error} 
            />
>>>>>>> 658c79da3fbe2a5cbec688b795f624538f54a5a3
          </PlainFab>
          <PlainFab  onPress={this.showConfirmDialog.bind(this, I18n.t('urgentCallTitle'),
                                                     I18n.t('urgentAmbulanceCallMessage'),
                                                     '+84982709185' )}>
            <Icon 
              name='ambulance'
              size={Metrics.icons.medium} 
              color={Colors.error} 
            />
          </PlainFab>
          <PlainFab  onPress={this.showConfirmDialog.bind(this, I18n.t('urgentCallTitle'),
                                                     I18n.t('urgentPoliceCallMessage'),
                                                     '+84982709185' )}>
            <Icon 
              name='bell'
              size={Metrics.icons.medium} 
              color={Colors.error} 
              />
          </PlainFab>
<<<<<<< HEAD
       </View>   
      )

    return (
      <View style={styles.screenContainer}>
        <MapScreen 
        />
        <View style={styles.infoIconContainer}>
          <SmallPlainFab onPress={this.handleShowPopUp.bind(this, fireItems, Metrics.screenWidth  / 10, 30)}>
            <Icon name="info" size={Metrics.icons.small} color="red" />
          </SmallPlainFab>
        </View>
        <BubblePopUp  items={this.state.items}
            elementWidth={Metrics.screenWidth * 4 / 5}
            elementHeight={30}
            isVisible={this.state.isPopupShow}
            onClose={this.handleClosePopUp.bind(this)}
            navigator={this.props.navigator}
            dispatch={this.props.dispatch}
        />
        {bottomButtons}
     </View>
=======
        </View>   
     </View> 
>>>>>>> 658c79da3fbe2a5cbec688b795f624538f54a5a3
    )
  }

  showConfirmDialog (_title, _message, _phoneNumber) {

     Alert.alert(
            _title,
            _message + _phoneNumber,
            [
               {text: 'Cancel', onPress: () => console.log('Cancel')},
              {text: 'OK', onPress: () =>  Communications.phonecall(_phoneNumber, false)},
            ]
    )
  }
}

<<<<<<< HEAD

const mapStateToProps = (state) => {
  return {
=======
const mapStateToProps = (state) => {
  return {
    loggedIn: state.login.username !== null,
    latitude: state.mapscreen.latitude,
    longitude: state.mapscreen.longitude,
>>>>>>> 658c79da3fbe2a5cbec688b795f624538f54a5a3
  }
}

export default connect(mapStateToProps)(AllComponentsScreen)